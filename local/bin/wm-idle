#!/bin/sh

# Default timeout (seconds)
AUTO_LOCK=120
SCREEN_OFF=300
# POWER_OFF=3600

# When use DE or WM, set XDG_CURRENT_DESKTOP first.
if [ "$XDG_CURRENT_DESKTOP" = "sway" ]; then

	exec swayidle -w timeout 60 'light -O && light -S 20' resume "light -I" \
		timeout $AUTO_LOCK 'swaylock -f' timeout $SCREEN_OFF 'swaymsg "output * power off"' \
		resume 'swaymsg "output * power on" && light -S 100' \
		before-sleep 'playctl pause' before-sleep 'swaylock'

elif [ "$XDG_CURRENT_DESKTOP" = "Hyprland" ]; then

	exec swayidle -w timeout 60 'light -O && light -S 20' resume "light -I" \
		timeout $AUTO_LOCK 'swaylock -f' timeout $SCREEN_OFF 'hyprctl dispatch dmps off' \
		resume 'hyprctl dispatch dmps on && light -S 100' \
		before-sleep 'playctl pause' before-sleep 'swaylock'

elif [ -z "$XDG_CURRENT_DESKTOP" ]; then

	notify-send "Please set \$XDG_CURRENT_DESKTOP" "You should set \$XDG_CURRENT_DESKTOP first!"

else
	sleep 5
	echo "Hello"
fi
